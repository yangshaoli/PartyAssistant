<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /> 
<title>报名页面 - 爱热闹</title>
<meta name="viewport" content="user-scalable=no, width=device-width" />
<link rel="stylesheet" href="/static/css/airenao.min.css" />
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0rc2/jquery.mobile.structure-1.0rc2.min.css" /> 
<script src="/static/js/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.js"></script>

<script>
    $(document).ready(function(){
        
        $('a[id^="tab_"]').bind('click', function(){
            $("#"+this.id).siblings().attr('style','');
            $("#"+this.id).attr('style','padding:7px;border:solid #ccc 1px;background: -webkit-linear-gradient(top,#fff,#eee);border-bottom:solid #fff 1px;');//改变样式
            
            var applystatus = this.id.split('_')[1];
            ajaxGetClients(applystatus);
        })
    })
$(document).bind("mobileinit", function(){
  $.mobile.foo = bar;
});

function ajaxGetClients(applystatus){
    $('.accordion_content table tbody').children().remove();
    
    $.ajax({
        type : 'GET',
        url: '/clients/invite_list_ajax/'+{{party.id}}+'/?apply='+applystatus,
        statusCode : {
        200: function(response){
            clients = JSON.parse(response);
            for (i in clients){
                row = "<tr><td></td><th>"+clients[i].name+"</th><td>"+clients[i].address+"</td><td></td></tr>"
                $('.accordion_content table tbody').append(row);    
            }
            
            //修改[再次邀请]的url
        },
        500: function(){ alert('没有获取到用户列表')}
        }
    });
}

</script>
</head>
<body>
<div data-role="page" id="home"> 
	<div data-role="header" style="background:red; border-bottom:solid #ffffff 1px">
	    <h1><img src="/static/images/logo.png"></h1>
    </div> 
	<div data-role="content">
		<h2>{{party.creator.username}} <span style="color:#999">邀请</span> 陈洋：</h2>
		<h2>{{party.start_time}} </h2>
		<h2>{{party.address}} <span style="color:#999">参加活动</span></h2>		
		<h2>{{party.description}}</h2>
        <form method="POST" url="{% url enroll party.id %}">
        {% if client %}
            <!-- 被邀请用户报名页面 -->
        	<div class="ui-block-a"><button type="submit" data-icon="check">参加</button></div>
        	<div class="ui-block-b"><button type="submit" data-icon="delete" data-theme="b">不参加</button></div>
        {% else %}

            <label for="basic">姓名:</label>
            <input type="text" name="name" id="id_name" value=""  />
            <label for="basic">Email:</label>
            <input type="text" name="email" id="id_email" value=""  />
            <label for="basic">手机:</label>
            <input type="text" name="phone" id="id_phone"/>
    
            <div class="ui-block-a"><button type="submit" data-icon="check" data-theme="c">参加</button></div>
    
        {% endif %}	
        </form>
	</div>
	<ul data-role="listview" data-inset="true" data-theme="a">
		<li><a href="index.html">已报名 <span class="ui-li-count">{{client_count.apply}}</span></a></li>
		<li><a href="index.html">未响应 <span class="ui-li-count">{{client_count.noanswer}}</span></a></li>
		<li><a href="index.html">不参加 <span class="ui-li-count">{{client_count.reject}}</span></a></li>
	</ul>
    <div data-role="navbar">
	<ul>
		<li><a href="/" data-theme="b">首页</a></li>
		<li><a href="{%url login %}" data-theme="b">登录</a></li>
        <li><a href="{%url register %}" data-theme="b">注册</a></li>
	</ul>
    </div>    
</div> 


<div data-role="page" id="yes" data-theme="c">
	<div data-role="header">
        <a href="#home" data-icon="arrow-l">返回</a>
		<h1>报名成功！</h1>
	</div><!-- /header -->

	<div data-role="content">	
		<p>您已经成功报名，请记得按时参加。</p>		
		<p><a href="#enroll">已报名列表</a></p>	
	</div><!-- /content -->
</div>


<div data-role="page" id="no"  data-theme="a">
	<div data-role="header">
        <a href="#home" data-icon="arrow-l">返回</a>
		<h1>不参加本次活动</h1>
	</div><!-- /header -->

	<div data-role="content">	
		<p>您已经选择不参加本次活动，感谢您的关注。</p>		
		<p><a href="#enroll">已报名列表</a></p>	
	</div><!-- /content -->
</div>

</body>
</html>